

%nl222 - 15 termos
if(l == 2 && ny == 2 && nu == 2)
    Regressores_0 = {'1';'0'; '0'; '0'; '0'; ...
                   '0';'0';'0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'};
    Regressores_u = {'0';'u_est(k-1)'; 'u_est(k-2)'; '0'; '0'; ...
                   '0';'0';'0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'};
    
    Regressores_y = {'0';'0'; '0'; 'y_est(k-1)'; 'y_est(k-2)'; ...
                   '0';'0';'0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'};
               
    Regressores_u2 = {'0';'0'; '0'; '0'; '0'; ...
                   'u_est(k-1)^2';'u_est(k-1)*u_est(k-2)';'u_est(k-2)^2'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   '0'};
    
    Regressores_y2 = {'0';'0'; '0'; '0'; '0'; ...
                   '0';'0';'0'; ...
                   '0'; '0'; ...
                   '0'; '0'; ...
                   'y_est(k-1)^2'; 'y_est(k-1)*y_est(k-2)'; ...
                   'y_est(k-2)^2'};           
end


%nl322 - 35 termos
if(l == 3 && ny == 2 && nu == 2)
    % Montar matriz de regressores
    
   Regressores_0 = {'1'; 
                    '0'; 
                    '0'; 
                    '0'; 
                    '0'; ...               
                    '0'; ... 
                    '0'; ... 
                    '0'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    '0'; ...                
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...                              
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...               
                    '0'; ...               
                    '0'; ...              
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
                
  Regressores_u = { '0'; 
                    'u_est(k-1)'; 
                    'u_est(k-2)'; 
                    '0'; 
                    '0'; ...               
                    '0'; ... 
                    '0'; ... 
                    '0'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    '0'; ...                
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...                              
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...               
                    '0'; ...               
                    '0'; ...              
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
                
  Regressores_y = { '0'; 
                    '0'; 
                    '0'; 
                    'y_est(k-1)'; 
                    'y_est(k-2)'; ...               
                    '0'; ... 
                    '0'; ... 
                    '0'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    '0'; ...                
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...                              
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...               
                    '0'; ...               
                    '0'; ...              
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
                
Regressores_yu2 = { '0'; 
                    '0'; 
                    '0'; 
                    '0'; 
                    '0'; ...               
                    '0'; ... 
                    '0'; ... 
                    '0'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    '0'; ...                
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...                              
                    'y_est(k-1)*u_est(k-1)^2'; ... 
                    'y_est(k-1)*u_est(k-1)*u_est(k-2)'; ...
                    'y_est(k-1)*u_est(k-2)^2'; ...               
                    'y_est(k-2)*u_est(k-1)^2'; ...
                    'y_est(k-2)*u_est(k-1)*u_est(k-2)'; ...
                    'y_est(k-2)*u_est(k-2)^2'; ...               
                    '0'; ...               
                    '0'; ...              
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
                
 Regressores_u2 = { '0'; 
                    '0'; 
                    '0'; 
                    '0'; 
                    '0'; ...               
                    'u_est(k-1)^2'; ... 
                    'u_est(k-1)*u_est(k-2)'; ... 
                    'u_est(k-2)^2'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    '0'; ...                
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...                              
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...               
                    '0'; ...               
                    '0'; ...              
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
                
 Regressores_y2 = { '0'; 
                    '0'; 
                    '0'; 
                    '0'; 
                    '0'; ...               
                    '0'; ... 
                    '0'; ... 
                    '0'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    '0'; ...                
                    'y_est(k-1)^2'; ... 
                    'y_est(k-1)*y_est(k-2)'; ...
                    'y_est(k-2)^2'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...                              
                    '0'; ... 
                    '0'; ...
                    '0'; ...               
                    '0'; ...
                    '0'; ...
                    '0'; ...               
                    '0'; ...               
                    '0'; ...              
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
               
end

%nl333 - 84 termos
if(l == 3 && ny == 3 && nu == 3)
   Regressores_0 = {'1'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'};
                
   Regressores_u = {'0'; ...
                    'u_est(k-1)'; ... 
                    'u_est(k-2)'; ...
                    'u_est(k-3)'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0';};
   Regressores_y = {'0'; ...
                    '0'; ... 
                    '0'; ...
                    '0'; ...
                    'y_est(k-1)'; ...
                    'y_est(k-2)'; ...
                    'y_est(k-3)'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'};
  Regressores_u2 = {'0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    'u_est(k-1)^2'; ...
                    'u_est(k-1)*u_est(k-2)'; ...
                    'u_est(k-1)*u_est(k-3)'; ... 
                    'u_est(k-2).^2'; ...
                    'u_est(k-2)*u(k-3)'; ...
                    'u_est(k-3).^2'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'};
  Regressores_y2 = {'0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    'y_est(k-1).^2'; ...
                    'y_est(k-1)*y_est(k-2)'; ...
                    'y_est(k-1)*y_est(k-3)'; ...
                    'y_est(k-2).^2'; ...
                    'y_est(k-2)*y_est(k-3)'; ...
                    'y_est(k-3).^2'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'};
  Regressores_yu = {'0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    'y_est(k-1)*u_est(k-1)'; ...
                    'y_est(k-1)*u_est(k-2)'; ...
                    'y_est(k-1)*u_est(k-3)'; ...
                    'y_est(k-2)*u_est(k-1)'; ...
                    'y_est(k-2)*u_est(k-2)'; ...
                    'y_est(k-2)*u_est(k-3)'; ...
                    'y_est(k-3)*u_est(k-1)'; ...
                    'y_est(k-3)*u_est(k-2)'; ...
                    'y_est(k-3)*u_est(k-3)'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'};
 Regressores_yu2 = {'0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    'y_est(k-1)*u_est(k-1).^2'; ...
                    'y_est(k-1)*u_est(k-1)*u_est(k-2)'; ...
                    'y_est(k-1)*u_est(k-1)*u_est(k-3)'; ...
                    'y_est(k-1)*u_est(k-2).^2'; ...
                    'y_est(k-1)*u_est(k-2)*u_est(k-3)'; ...
                    'y_est(k-1)*u_est(k-3).^2'; ...
                    'y_est(k-2)*u_est(k-1).^2'; ...
                    'y_est(k-2)*u_est(k-1)*u_est(k-2)'; ...
                    'y_est(k-2)*u_est(k-1)*u_est(k-3)'; ...
                    'y_est(k-2)*u_est(k-2).^2'; ...
                    'y_est(k-2)*u_est(k-2)*u_est(k-3)'; ...
                    'y_est(k-2)*u_est(k-3).^2'; ...
                    'y_est(k-3)*u_est(k-1).^2'; ...
                    'y_est(k-3)*u_est(k-1)*u_est(k-2)'; ...
                    'y_est(k-3)*u_est(k-1)*u_est(k-3)'; ...
                    'y_est(k-3)*u_est(k-2).^2'; ...
                    'y_est(k-3)*u_est(k-2)*u_est(k-3)'; ...
                    'y_est(k-3)*u_est(k-3).^2'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'; ...
                    '0'};
end